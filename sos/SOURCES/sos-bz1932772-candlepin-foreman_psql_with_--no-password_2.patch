From f04fc149a051e7519b9fe375f47e4d4bae79833c Mon Sep 17 00:00:00 2001
From: Jan Jansky <jjansky@redhat.com>
Date: Mon, 1 Mar 2021 13:22:16 +0100
Subject: [PATCH] [candlepin] call psql with --no-password to avoid waiting on
 input

Backport #2422 to legacy-3.9.

Signed-off-by: Jan Jansky <jjansky@redhat.com>
Signed-off-by: Jake Hunsaker <jhunsake@redhat.com>
---
 sos/plugins/candlepin.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/sos/plugins/candlepin.py b/sos/plugins/candlepin.py
index 243b5f5..e51c646 100644
--- a/sos/plugins/candlepin.py
+++ b/sos/plugins/candlepin.py
@@ -92,7 +92,8 @@ class Candlepin(Plugin, RedHatPlugin):
         a large amount of quoting in sos logs referencing the command being run
         """
         csvformat = "-A -F , -X" if csv else ""
-        _dbcmd = "psql -h %s -p 5432 -U candlepin -d candlepin %s -c %s"
+        _dbcmd = "psql --no-password -h %s -p 5432 -U candlepin \
+                  -d candlepin %s -c %s"
         return _dbcmd % (self.dbhost, csvformat, quote(query))
 
     def postproc(self):
-- 
1.8.3.1

