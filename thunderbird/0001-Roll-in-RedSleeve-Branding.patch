From 98a53e7b3d10ad60ab9bf8b429048cf11ef461b4 Mon Sep 17 00:00:00 2001
From: Jacco Ligthart <jacco@redsleeve.org>
Date: Sun, 28 Jan 2018 06:52:22 +0100
Subject: [PATCH] Roll in RedSleeve Branding

---
 SOURCES/thunderbird-redsleeve-default-prefs.js.el6 | 28 ++++++++++++++++++++++
 SOURCES/thunderbird-redsleeve-default-prefs.js.el7 | 28 ++++++++++++++++++++++
 SPECS/thunderbird.spec                             | 14 +++++++----
 3 files changed, 65 insertions(+), 5 deletions(-)
 create mode 100644 SOURCES/thunderbird-redsleeve-default-prefs.js.el6
 create mode 100644 SOURCES/thunderbird-redsleeve-default-prefs.js.el7

diff --git a/SOURCES/thunderbird-redsleeve-default-prefs.js.el6 b/SOURCES/thunderbird-redsleeve-default-prefs.js.el6
new file mode 100644
index 0000000..fa9821b
--- /dev/null
+++ b/SOURCES/thunderbird-redsleeve-default-prefs.js.el6
@@ -0,0 +1,28 @@
+pref("app.update.enabled", false);
+pref("app.update.autoInstallEnabled", false);
+# Allow users to set custom colors
+# pref("browser.display.use_system_colors",   true);
+pref("general.useragent.vendor", " RedSleeve");
+pref("general.useragent.vendorSub", "THUNDERBIRD_RPM_VR");
+pref("intl.locale.matchOS", true);
+pref("mail.shell.checkDefaultClient", false);
+pref("toolkit.networkmanager.disable", false);
+pref("offline.autoDetect", true);
+
+# Disable global indexing by default
+pref("mailnews.database.global.indexer.enabled", false);
+
+# Do not switch to Smart Folders after upgrade to 3.0b4
+pref("mail.folder.views.version", "1")
+pref("extensions.shownSelectionUI", true);
+pref("extensions.autoDisableScope", 0);
+
+# For rhbz#1024232
+pref("ui.SpellCheckerUnderlineStyle",       1);
+
+/* Workaround for rhbz#1134876 */
+pref("javascript.options.baselinejit",      false);
+/* Workaround for rhbz#1110291 */
+pref("network.negotiate-auth.allow-insecure-ntlm-v1", true);
+/* Workaround for mozbz#1063315 */
+pref("security.use_mozillapkix_verification", false);
diff --git a/SOURCES/thunderbird-redsleeve-default-prefs.js.el7 b/SOURCES/thunderbird-redsleeve-default-prefs.js.el7
new file mode 100644
index 0000000..fa9821b
--- /dev/null
+++ b/SOURCES/thunderbird-redsleeve-default-prefs.js.el7
@@ -0,0 +1,28 @@
+pref("app.update.enabled", false);
+pref("app.update.autoInstallEnabled", false);
+# Allow users to set custom colors
+# pref("browser.display.use_system_colors",   true);
+pref("general.useragent.vendor", " RedSleeve");
+pref("general.useragent.vendorSub", "THUNDERBIRD_RPM_VR");
+pref("intl.locale.matchOS", true);
+pref("mail.shell.checkDefaultClient", false);
+pref("toolkit.networkmanager.disable", false);
+pref("offline.autoDetect", true);
+
+# Disable global indexing by default
+pref("mailnews.database.global.indexer.enabled", false);
+
+# Do not switch to Smart Folders after upgrade to 3.0b4
+pref("mail.folder.views.version", "1")
+pref("extensions.shownSelectionUI", true);
+pref("extensions.autoDisableScope", 0);
+
+# For rhbz#1024232
+pref("ui.SpellCheckerUnderlineStyle",       1);
+
+/* Workaround for rhbz#1134876 */
+pref("javascript.options.baselinejit",      false);
+/* Workaround for rhbz#1110291 */
+pref("network.negotiate-auth.allow-insecure-ntlm-v1", true);
+/* Workaround for mozbz#1063315 */
+pref("security.use_mozillapkix_verification", false);
diff --git a/SPECS/thunderbird.spec b/SPECS/thunderbird.spec
index 594c02b..60fc1fe 100644
--- a/SPECS/thunderbird.spec
+++ b/SPECS/thunderbird.spec
@@ -75,7 +75,7 @@
 Summary:        Mozilla Thunderbird mail/newsgroup client
 Name:           thunderbird
 Version:        52.5.2
-Release:        1%{?dist}
+Release:        1%{?dist}.redsleeve
 URL:            http://www.mozilla.org/projects/thunderbird/
 License:        MPLv1.1 or GPLv2+ or LGPLv2+
 Group:          Applications/Internet
@@ -102,9 +102,9 @@ Source300:      gcc48-%{gcc_version}.el5.src.rpm
 Source301:      yasm-1.2.0-3.el5.src.rpm
 Source302:      devtoolset-2-binutils-2.23.52.0.1-10.el5.src.rpm
 Source600:      thunderbird.sh.in.rhel6
-Source601:      thunderbird-redhat-default-prefs.js.el6
+Source601:      thunderbird-redsleeve-default-prefs.js.el6
 Source700:      thunderbird.sh.in.rhel7
-Source701:      thunderbird-redhat-default-prefs.js.el7
+Source701:      thunderbird-redsleeve-default-prefs.js.el7
 
 # Mozilla (XULRunner) patches
 Patch0:         firefox-install-dir.patch
@@ -637,8 +637,8 @@ MOZ_SMP_FLAGS=-j1
 [ -z "$RPM_BUILD_NCPUS" ] && \
      RPM_BUILD_NCPUS="`/usr/bin/getconf _NPROCESSORS_ONLN`"
 [ "$RPM_BUILD_NCPUS" -ge 2 ] && MOZ_SMP_FLAGS=-j2
-[ "$RPM_BUILD_NCPUS" -ge 4 ] && MOZ_SMP_FLAGS=-j4
-[ "$RPM_BUILD_NCPUS" -ge 8 ] && MOZ_SMP_FLAGS=-j8
+#[ "$RPM_BUILD_NCPUS" -ge 4 ] && MOZ_SMP_FLAGS=-j4
+#[ "$RPM_BUILD_NCPUS" -ge 8 ] && MOZ_SMP_FLAGS=-j8
 #FIXME echo "test config.guess"
 #./mozilla/build/autoconf/config.guess
 #echo "test LDAP config.guess"
@@ -858,6 +858,10 @@ gtk-update-icon-cache %{_datadir}/icons/hicolor &>/dev/null || :
 #===============================================================================
 
 %changelog
+* Fri Jan 26 2018 Jacco Ligthart <jacco@redsleeve.org> - 52.5.2-1.redsleeve
+- Set max CPU's to 2
+- Roll in RedSleeve Branding
+
 * Mon Jan  8 2018 Johnny Hughes <johnny@centos.org> - 52.5.2-1
 - Manual CentOS Debranding
 
-- 
1.8.3.1

