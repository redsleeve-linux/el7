From f9b0c9a296453cd817cc5d9a2e54ec6b4e123967 Mon Sep 17 00:00:00 2001
From: Jakub Filak <jfilak@redhat.com>
Date: Tue, 25 Feb 2014 17:53:42 +0100
Subject: [ABRT PATCH 39/40] ccpp: run vulnerability analysis in
 analyze_LocalGDB

The vulnerability analysis has been moved from 'post-create' to
'analyze_LocalGDB' because gdb should not be run for random coredump
under root user.

Closes rhbz#1069719

Signed-off-by: Jakub Filak <jfilak@redhat.com>
---
 src/plugins/ccpp_event.conf | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/plugins/ccpp_event.conf b/src/plugins/ccpp_event.conf
index ccc9e83..62ff08a 100644
--- a/src/plugins/ccpp_event.conf
+++ b/src/plugins/ccpp_event.conf
@@ -19,8 +19,6 @@ EVENT=post-create analyzer=CCpp
         ##satyr migration:
         #satyr abrt-create-core-stacktrace "$DUMP_DIR"
         abrt-action-generate-core-backtrace
-        # Run GDB plugin to see if crash looks exploitable
-        abrt-action-analyze-vulnerability
         # Generate hash
         abrt-action-analyze-c &&
         abrt-action-list-dsos -m maps -o dso_list &&
@@ -70,6 +68,9 @@ EVENT=collect_xsession_errors analyzer=CCpp dso_list~=.*/libX11.*
 # TODO: can we still specify additional directories to search for debuginfos,
 # or was this ability lost with move to python installer?
 EVENT=analyze_LocalGDB analyzer=CCpp
+        # Run GDB plugin to see if crash looks exploitable
+        abrt-action-analyze-vulnerability
+        # Run GDB to genereate backtrace
         abrt-action-analyze-ccpp-local --without-bodhi
 
 
-- 
1.8.3.1

