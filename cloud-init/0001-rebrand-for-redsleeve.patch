From 8580ce2af83c99c680b8464f072ce2fa8e278f03 Mon Sep 17 00:00:00 2001
From: Jacco Ligthart <jacco@redsleeve.org>
Date: Wed, 21 Mar 2018 21:56:26 +0100
Subject: [PATCH] rebrand for redsleeve

---
 SOURCES/cloud-init-add-redsleeve-os.patch | 43 +++++++++++++++++++++++++++++++
 SOURCES/cloud-init-rhel.cfg               |  2 +-
 SPECS/cloud-init.spec                     |  7 +++--
 3 files changed, 49 insertions(+), 3 deletions(-)
 create mode 100644 SOURCES/cloud-init-add-redsleeve-os.patch

diff --git a/SOURCES/cloud-init-add-redsleeve-os.patch b/SOURCES/cloud-init-add-redsleeve-os.patch
new file mode 100644
index 0000000..5b5c57b
--- /dev/null
+++ b/SOURCES/cloud-init-add-redsleeve-os.patch
@@ -0,0 +1,43 @@
+diff --git a/cloudinit/distros/__init__.py b/cloudinit/distros/__init__.py
+index f56c0cf..1fd48a7 100755
+--- a/cloudinit/distros/__init__.py
++++ b/cloudinit/distros/__init__.py
+@@ -32,7 +32,7 @@ from cloudinit.distros.parsers import hosts
+ 
+ OSFAMILIES = {
+     'debian': ['debian', 'ubuntu'],
+-    'redhat': ['fedora', 'rhel'],
++    'redhat': ['redsleeve', 'fedora', 'rhel'],
+     'gentoo': ['gentoo'],
+     'freebsd': ['freebsd'],
+     'suse': ['sles'],
+diff --git a/cloudinit/distros/redsleeve.py b/cloudinit/distros/redsleeve.py
+new file mode 100644
+index 0000000..4b803d2
+--- /dev/null
++++ b/cloudinit/distros/redsleeve.py
+@@ -0,0 +1,12 @@
++# This file is part of cloud-init. See LICENSE file for license information.
++
++from cloudinit.distros import rhel
++from cloudinit import log as logging
++
++LOG = logging.getLogger(__name__)
++
++
++class Distro(rhel.Distro):
++    pass
++
++# vi: ts=4 expandtab
+diff -uNr cloud-init-0.7.9__orig/rhel/cloud.cfg cloud-init-0.7.9/rhel/cloud.cfg
+--- cloud-init-0.7.9__orig/rhel/cloud.cfg	2017-09-05 22:20:14.302075947 +0100
++++ cloud-init-0.7.9/rhel/cloud.cfg	2017-09-05 22:20:37.912076373 +0100
+@@ -52,7 +52,7 @@
+ 
+ system_info:
+   default_user:
+-    name: cloud-user
++    name: redsleeve
+     lock_passwd: true
+     gecos: Cloud User
+     groups: [wheel, adm, systemd-journal]
diff --git a/SOURCES/cloud-init-rhel.cfg b/SOURCES/cloud-init-rhel.cfg
index 675df1c..e0df9f4 100644
--- a/SOURCES/cloud-init-rhel.cfg
+++ b/SOURCES/cloud-init-rhel.cfg
@@ -51,7 +51,7 @@ cloud_final_modules:
 
 system_info:
   default_user:
-    name: centos
+    name: redsleeve
     lock_passwd: true
     gecos: Cloud User
     groups: [wheel, adm, systemd-journal]
diff --git a/SPECS/cloud-init.spec b/SPECS/cloud-init.spec
index 6db5679..0ea9133 100644
--- a/SPECS/cloud-init.spec
+++ b/SPECS/cloud-init.spec
@@ -7,7 +7,7 @@
 
 Name:           cloud-init
 Version:        0.7.9
-Release:        9%{?dist}.6
+Release:        9%{?dist}.6.redsleeve
 Summary:        Cloud instance init scripts
 
 Group:          System Environment/Base
@@ -55,7 +55,7 @@ Patch0030: 0030-Render-the-GATEWAY-value-in-interface-files-which-ha.patch
 Patch0031: 0031-sysconfig-Don-t-write-BOOTPROTO-dhcp-for-ipv6-dhcp.patch
 Patch0032: 0032-sysconfig-Render-IPV6_DEFAULTGW-correctly.patch
 Patch0033: 0033-sysconfig-Render-DNS-and-DOMAIN.patch
-Patch9999: cloud-init-add-centos-os.patch
+Patch9999: cloud-init-add-redsleeve-os.patch
 
 # Deal with noarch -> arch
 # https://bugzilla.redhat.com/show_bug.cgi?id=1067089
@@ -191,6 +191,9 @@ fi
 %config(noreplace) %{_sysconfdir}/rsyslog.d/21-cloudinit.conf
 
 %changelog
+* Wed Mar 21 2018 Jacco Ligthart <jacco@redsleeve.org 0.7.9-9.el7.6.redsleeve
+- rebrand for redsleeve
+
 * Wed Mar  7 2018 Johnny Hughes <johnny@centos.org> 0.7.9-9.6
 - Manual CentOS Debranding
 
-- 
1.8.3.1

