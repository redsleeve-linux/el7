From 5594c3dac2df8948d09f148a5a766db77a7b0952 Mon Sep 17 00:00:00 2001
From: progier389 <progier@redhat.com>
Date: Thu, 20 Jan 2022 12:22:28 +0100
Subject: [PATCH 1/3] Issue 5098 - Multiple issues around replication and CI
 test test_online_reinit_may_hang (#5109)

---
 ldap/servers/plugins/replication/repl5_replica.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ldap/servers/plugins/replication/repl5_replica.c b/ldap/servers/plugins/replication/repl5_replica.c
index c1b3ed73c..253a3ef9f 100644
--- a/ldap/servers/plugins/replication/repl5_replica.c
+++ b/ldap/servers/plugins/replication/repl5_replica.c
@@ -1641,7 +1641,7 @@ replica_check_for_data_reload(Replica *r, void *arg __attribute__((unused)))
             return -1;
         }
 
-        if (upper_bound_ruv) {
+        if (upper_bound_ruv && ruv_replica_count(upper_bound_ruv) > 0) {
             ruv_obj = replica_get_ruv(r);
             r_ruv = object_get_data(ruv_obj);
             PR_ASSERT(r_ruv);
-- 
2.37.3

