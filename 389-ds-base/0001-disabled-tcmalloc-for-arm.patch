From 134ac38df9906123c5b96e5b422313205d100ab1 Mon Sep 17 00:00:00 2001
From: Jacco Ligthart <jacco@redsleeve.org>
Date: Sun, 12 Mar 2023 23:29:24 +0100
Subject: [PATCH] disabled tcmalloc for arm

---
 SPECS/389-ds-base.spec | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/SPECS/389-ds-base.spec b/SPECS/389-ds-base.spec
index e3b2867..d729e15 100644
--- a/SPECS/389-ds-base.spec
+++ b/SPECS/389-ds-base.spec
@@ -14,13 +14,13 @@
 # This is used in certain builds to help us know if it has extra features.
 %global variant base
 %global use_asan 0
-%global use_rust 1
+%global use_rust 0
 
 %if %{use_asan}
 %global use_tcmalloc 0
 %global variant base-asan
 %else
-%if "%{_arch}" != "s390x" && "%{_arch}" != "s390"
+%ifnarch s390 s390x %{arm}
 %global use_tcmalloc 1
 %else
 %global use_tcmalloc 0
@@ -41,7 +41,7 @@
 Summary:          389 Directory Server (%{variant})
 Name:             389-ds-base
 Version:          1.3.11.1
-Release:          %{?relprefix}1%{?prerel}%{?dist}
+Release:          %{?relprefix}1%{?prerel}%{?dist}.redsleeve
 License:          GPLv3+
 URL:              https://www.port389.org/
 Group:            System Environment/Daemons
@@ -568,6 +568,9 @@ fi
 %{_sysconfdir}/%{pkgname}/dirsrvtests
 
 %changelog
+* Sun Mar 12 2023 Jacco Ligthart <jacco@redsleeve.org> - 1.3.11.1-1.redsleeve
+- disabled tcmalloc for arm
+
 * Tue Feb 21 2023 Simon Pichugin <spichugi@redhat.com> - 1.3.11.1-1
 - Bump version to 1.3.11.1-1
 - Resolves: Bug 2170224 - Backport Rust password storage PBKDF2 schemes
-- 
1.8.3.1

