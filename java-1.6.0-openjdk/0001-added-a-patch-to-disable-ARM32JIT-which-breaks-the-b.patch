From cf7de835a88b94c8db59c75b0313f698ade0556b Mon Sep 17 00:00:00 2001
From: Jacco Ligthart <jacco@redsleeve.org>
Date: Fri, 16 Dec 2016 10:34:28 +0100
Subject: [PATCH] added a patch to disable ARM32JIT, which breaks the build

---
 SOURCES/hotspot-disable-arm32-jit.diff | 11 +++++++++++
 SPECS/java-1.6.0-openjdk.spec          |  9 ++++++++-
 2 files changed, 19 insertions(+), 1 deletion(-)
 create mode 100644 SOURCES/hotspot-disable-arm32-jit.diff

diff --git a/SOURCES/hotspot-disable-arm32-jit.diff b/SOURCES/hotspot-disable-arm32-jit.diff
new file mode 100644
index 0000000..8fb19c3
--- /dev/null
+++ b/SOURCES/hotspot-disable-arm32-jit.diff
@@ -0,0 +1,11 @@
+--- openjdk/hotspot/make/linux/makefiles/zeroshark.make
++++ openjdk/hotspot/make/linux/makefiles/zeroshark.make
+@@ -25,7 +25,7 @@
+ 
+ # Setup common to Zero (non-Shark) and Shark versions of VM
+ 
+-ifeq ($(ZERO_LIBARCH),arm)
++ifeq ($(ZERO_LIBARCH),armDISABLED)
+ 
+ Obj_Files += asm_helper.o
+ Obj_Files += cppInterpreter_arm.o
diff --git a/SPECS/java-1.6.0-openjdk.spec b/SPECS/java-1.6.0-openjdk.spec
index 1fe59ba..f783eef 100644
--- a/SPECS/java-1.6.0-openjdk.spec
+++ b/SPECS/java-1.6.0-openjdk.spec
@@ -158,7 +158,7 @@
 
 Name:    java-%{javaver}-%{origin}
 Version: %{javaver}.%{buildver}
-Release: %{icedteaver}.9%{?dist}
+Release: %{icedteaver}.9%{?dist}.redsleeve
 # java-1.5.0-ibm from jpackage.org set Epoch to 1 for unknown reasons,
 # and this change was brought into RHEL-4.  java-1.5.0-ibm packages
 # also included the epoch in their virtual provides.  This created a
@@ -205,6 +205,8 @@ Patch12: pr2808.patch
 # PR2849: wget not required when downloading is disabled
 Patch13: pr2849.patch
 
+Patch100: hotspot-disable-arm32-jit.diff
+
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
 
 
@@ -399,6 +401,8 @@ make DISTRIBUTION_PATCHES="patches/add-final-location-rpaths.patch patches/openj
 patch -l -p0 < %{PATCH3}
 patch -l -p0 < %{PATCH4}
 
+patch -l -p0 < %{PATCH100}
+
 %if %{debug}
 patch -l -p0 < %{PATCH5}
 patch -l -p0 < %{PATCH6}
@@ -898,6 +902,9 @@ exit 0
 %doc %{_javadocdir}/%{name}
 
 %changelog
+* Sun Nov 06 2016 Jacco Ligthart <jacco@redsleeve.org> 1:1.6.0.40-1.13.12.9.redsleeve
+- added a patch to disable ARM32JIT, which breaks the build
+
 * Mon Sep 05 2016 Andrew Hughes <gnu.andrew@redhat.com> - 1:1.6.0.40-1.13.12.9
 - Require a JDK with RH1334465/PR2956 fixed and turn off bootstrapping for Zero architectures.
 - Resolves: rhbz#1350047
-- 
1.8.3.1

