From 327852f029b9d70613cdce223f57bdc1e97210ac Mon Sep 17 00:00:00 2001
From: Miroslav Rezanina <mrezanin@redhat.com>
Date: Thu, 5 Nov 2015 10:38:15 +0100
Subject: Initial redhat build

Switch to new unified build structure.

Rebase to 2.5:
- New seccomp hadling in configure
- libcacard extracted
- vnc fixes
- libsecomp for aarch64 requirements changed downstream
- guest-agent separated from qemu-kvm

Rebase to 2.4:
    - remove --enable-ws-vnc
    - use error_setg instead of error_set in migration/migration.c
    - remove target-x86_64.conf
    - create /etc/qemu-kvm on copying of bridge.conf
    - disabled opengl
    - rebased to version 2.3.0-30.el7

Included commits (rebase 2.4)
    - 9201274 spec: Remove obsolete differentiation code
    - a938a8c spec: Use external configuration script
    - 5ca8d0e spec: Use configure options to prevent default resolution
    - 5dca391 spec: Ship complete QMP documentation files
    - 7899edd aarch64: allow --enable-seccomp
    - a56fb9c aarch64: redhat spec: enable seccomp
    - a9571e6 rhel: Update package version for SLOF dependency
    - 25c70c4 configure: Add support for tcmalloc
    - db72485 Change fsreeze-hook default location
    - 14b8a9e redhat: add kvm-unit-tests tarball to environment
    - 5ee4238 spec: Build tscdeadline_latency.flat from kvm-unit-tests
    - 6ba800b Downstream-only: Start kvm-setup service before libvirtd service
    - 59b43d6 Do not stop qemu-guest-agent service on target switch
    - 4d851fa provide vhost module config file with max_mem_regions set to 509
    - 0b18027 spec: Require proper version of SLOF
    - 3c436c7 Fix rh-brew-aarch64, rh-brew-ppc rh-brew-ga-ppc target
---
 .gitpublish                           |   8 +
 configure                             |   4 +-
 redhat/.gitignore                     |   1 +
 redhat/99-qemu-guest-agent.rules      |   2 +
 redhat/Makefile                       |  72 ++++++
 redhat/Makefile.common                |  35 +++
 redhat/build_configure.sh             | 116 ++++++++++
 redhat/qemu-ga.sysconfig              |  19 ++
 redhat/qemu-guest-agent.service       |  21 ++
 redhat/qemu-guest-agent.spec.template | 408 ++++++++++++++++++++++++++++++++++
 redhat/rpmbuild/BUILD/.gitignore      |   2 +
 redhat/rpmbuild/RPMS/.gitignore       |   2 +
 redhat/rpmbuild/SOURCES/.gitignore    |   2 +
 redhat/rpmbuild/SPECS/.gitignore      |   2 +
 redhat/rpmbuild/SRPMS/.gitignore      |   2 +
 redhat/scripts/frh.py                 |  27 +++
 redhat/scripts/git-backport-diff      | 302 +++++++++++++++++++++++++
 redhat/scripts/git-compile-check      | 215 ++++++++++++++++++
 redhat/scripts/process-patches.sh     |  70 ++++++
 redhat/scripts/tarball_checksum.sh    |   3 +
 20 files changed, 1311 insertions(+), 2 deletions(-)
 create mode 100644 .gitpublish
 create mode 100644 redhat/.gitignore
 create mode 100644 redhat/99-qemu-guest-agent.rules
 create mode 100644 redhat/Makefile
 create mode 100644 redhat/Makefile.common
 create mode 100755 redhat/build_configure.sh
 create mode 100644 redhat/qemu-ga.sysconfig
 create mode 100644 redhat/qemu-guest-agent.service
 create mode 100644 redhat/qemu-guest-agent.spec.template
 create mode 100644 redhat/rpmbuild/BUILD/.gitignore
 create mode 100644 redhat/rpmbuild/RPMS/.gitignore
 create mode 100644 redhat/rpmbuild/SOURCES/.gitignore
 create mode 100644 redhat/rpmbuild/SPECS/.gitignore
 create mode 100644 redhat/rpmbuild/SRPMS/.gitignore
 create mode 100755 redhat/scripts/frh.py
 create mode 100755 redhat/scripts/git-backport-diff
 create mode 100755 redhat/scripts/git-compile-check
 create mode 100755 redhat/scripts/process-patches.sh
 create mode 100755 redhat/scripts/tarball_checksum.sh

diff --git a/configure b/configure
index b9552fd..38e233e 100755
--- a/configure
+++ b/configure
@@ -1904,10 +1904,10 @@ fi
 
 if test "$seccomp" != "no" ; then
     case "$cpu" in
-    i386|x86_64)
+    i386|x86_64|aarch64)
         libseccomp_minver="2.1.0"
         ;;
-    arm|aarch64)
+    arm)
         libseccomp_minver="2.2.3"
         ;;
     *)
