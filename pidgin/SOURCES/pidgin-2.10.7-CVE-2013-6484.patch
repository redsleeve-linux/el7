diff -up pidgin-2.10.7/libpurple/stun.c.CVE-2013-6484 pidgin-2.10.7/libpurple/stun.c
--- pidgin-2.10.7/libpurple/stun.c.CVE-2013-6484	2013-02-11 04:16:53.000000000 -0500
+++ pidgin-2.10.7/libpurple/stun.c	2014-01-29 13:08:18.835817422 -0500
@@ -175,7 +175,7 @@ static void reply_cb(gpointer data, gint
 	struct sockaddr_in *sinptr;
 
 	len = recv(source, buffer, sizeof(buffer) - 1, 0);
-	if (!len) {
+	if (len < 0) {
 		purple_debug_warning("stun", "unable to read stun response\n");
 		return;
 	}
